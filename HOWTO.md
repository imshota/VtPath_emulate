# 実装方法
 ## Tritonで全てのパスを通る入力を計算する。
 - 今回はコンコリック実行で実装する。
 - アルゴリズム
   - 最初のエミュレートで仮想パスを入手
   - 分岐アドレスにおいて、Tritonでもう一方の分岐にいく入力を見つける。
 - 出来上がった入力は、ファイルに出力する予定。

 ## PinでTritonで作られた入力ファイルから、VPパスを作り、トレーニング（-t）か、検出（-d）をする。
 - アルゴリズム
   - 命令ごとに計装する。
     - 静的なイメージの中のシステムコール
       - そのままPCをpushし、VtPathを作ってpopする。
     - 動的なイメージの中のシステムコール
       - 相対PCをpushし、VtPathを作ってpopする。
     - call命令
       -　次の命令アドレス（リターンアドレス）をpushする。
     - rtn命令
       - リターンアドレスをpopする。
   - ファイルVPtable.txtからVPテーブルを作り
     - トレーニングモード
       - VPテーブルに入っていないものを入れ、VPテーブルをVPtable.txtに出力
     - 検出モード
       - それぞれの仮想パスがVPテーブルに入っているか確認する。
       - 保存してきたVtPathをVP集合に属しているか（.countで)判定
         - 入っている　→　異常なし
         - 入っていない　→　異常(パス異常)
 - VStack, preStackはstack型で保存
 - VtPathの型はvector型、真ん中で移り変わる際に0を入れて区切りとした。
 - VPテーブルはmapとして表した。
